<!DOCTYPE html>
<html lang="my">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MiniMyId ‚Äî Music + Profile</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0f1116;
    --card:#141519;
    --muted:#9aa0a6;
    --accent:#7b61ff;
    --accent2:#00e5ff;
    --glass: rgba(255,255,255,0.03);
    --danger:#ff4b6e;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:"Poppins",system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;
    background: linear-gradient(180deg,#0b0c0f 0%, #0f1116 100%);
    color:#fff;
    -webkit-font-smoothing:antialiased;
  }

  /* App wrapper */
  .app {
    max-width:720px;
    margin:0 auto;
    min-height:100vh;
    display:flex;
    flex-direction:column;
  }

  /* Top header */
  header.app-header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:14px 18px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
    border-bottom:1px solid rgba(255,255,255,0.03);
  }
  .brand { display:flex; align-items:center; gap:12px; }
  .logo {
    width:38px; height:38px; border-radius:10px;
    background: linear-gradient(135deg,var(--accent),var(--accent2));
    display:flex; align-items:center; justify-content:center;
    font-weight:700; color:#fff; box-shadow:0 6px 18px rgba(123,97,255,0.12);
  }
  .title { font-weight:600; font-size:16px; }
  .header-icons { display:flex; gap:10px; align-items:center; }

  .icon-btn{
    width:40px; height:40px; border-radius:10px; border:none;
    background:var(--card); color:#fff; display:flex; align-items:center; justify-content:center;
    box-shadow: 0 6px 18px rgba(0,0,0,0.5);
    cursor:pointer; font-size:18px;
  }

  /* content area */
  .content {
    padding:18px;
    flex:1;
    display:flex;
    flex-direction:column;
    gap:12px;
  }

  /* card style */
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:14px;
    padding:14px;
    box-shadow: 0 8px 28px rgba(2,6,23,0.6);
    border:1px solid rgba(255,255,255,0.02);
  }

  /* Main page visuals */
  .game-center { text-align:center; padding:10px 0 18px; }
  .stats-grid { display:grid; grid-template-columns:repeat(1,1fr); gap:12px; }
  @media(min-width:600px){ .stats-grid{ grid-template-columns:repeat(2,1fr); } }

  .stat{
    padding:18px; border-radius:12px; background:linear-gradient(180deg,#111217,#15161b);
    display:flex; flex-direction:column; align-items:center; gap:8px;
  }
  .stat .label{ color:var(--muted); font-size:13px }
  .stat .value{ font-size:20px; font-weight:700 }

  /* Profile page */
  .profile {
    display:flex; flex-direction:column; align-items:center; gap:12px; padding-top:8px;
  }
  .profile img {
    width:110px; height:110px; border-radius:50%;
    border:4px solid rgba(255,255,255,0.04);
    object-fit:cover;
    background:#222;
  }
  .profile .row { display:flex; gap:8px; align-items:center; color:var(--muted); }
  .profile .value { color:#fff; font-weight:600 }

  /* Bottom nav */
  nav.bottom-nav {
    position:sticky; bottom:0; left:0; right:0;
    padding:10px; background: linear-gradient(0deg, rgba(0,0,0,0.2), transparent);
    display:flex; justify-content:space-between; gap:8px;
    border-top:1px solid rgba(255,255,255,0.02);
  }
  .nav-btn{
    flex:1; padding:10px 14px; border-radius:12px; border:none; background:var(--card);
    color:var(--muted); font-weight:600; cursor:pointer;
  }
  .nav-btn.active{ color:#fff; background: linear-gradient(90deg,var(--accent),var(--accent2)); box-shadow:0 6px 18px rgba(123,97,255,0.12) }

  /* Music modal */
  .modal {
    position:fixed; inset:0; display:none; align-items:center; justify-content:center;
    background: rgba(0,0,0,0.6); z-index:60;
  }
  .modal .modal-card{
    width:min(520px,94%); background:linear-gradient(180deg,#15161b,#111217); border-radius:14px; padding:18px;
    border:1px solid rgba(255,255,255,0.02);
  }
  .modal h3{ margin:0 0 12px 0; text-align:center; color:#fff }
  .modal .option{
    display:flex; gap:12px; align-items:center; padding:12px; border-radius:10px; background:rgba(255,255,255,0.02);
    margin-bottom:10px; cursor:pointer;
  }
  .modal .option .ico{ font-size:20px; width:36px; height:36px; display:flex; align-items:center; justify-content:center; border-radius:8px; background:rgba(255,255,255,0.02) }
  .modal .option .text { display:flex; flex-direction:column; }
  .modal .option .title { font-weight:600 }
  .modal .option .sub { color:var(--muted); font-size:13px }

  .modal .cancel { margin-top:6px; background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted); padding:10px; width:100%; border-radius:10px; cursor:pointer }

  /* Small music control bar */
  .player-bar {
    display:flex; gap:12px; align-items:center; padding:10px 12px; background:rgba(0,0,0,0.4); border-radius:12px;
    border:1px solid rgba(255,255,255,0.03);
  }
  .player-bar .meta { flex:1; min-width:0; overflow:hidden }
  .player-bar .meta .title { font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
  .player-bar .controls { display:flex; gap:8px; align-items:center }
  .player-bar button{ background:none; border:none; color:#fff; font-size:18px; cursor:pointer }

  /* tiny utilities */
  .small{ font-size:13px; color:var(--muted) }
  .muted{ color:var(--muted) }
</style>
</head>
<body>
  <div class="app" id="app">
    <!-- HEADER -->
    <header class="app-header">
      <div class="brand">
        <div class="logo">MM</div>
        <div>
          <div class="title">MiniMyId</div>
          <div class="small muted">Game Center</div>
        </div>
      </div>

      <div class="header-icons">
        <button class="icon-btn" id="imgBtn" title="Change Image">üñºÔ∏è</button>
        <button class="icon-btn" id="musicBtn" title="Custom Music">üéµ</button>
        <button class="icon-btn" id="volumeBtn" title="Mute/Unmute">üîä</button>
      </div>
    </header>

    <!-- CONTENT -->
    <main class="content">
      <!-- MAIN PAGE -->
      <section id="mainPage" class="card">
        <div class="game-center">
          <h2 style="margin:0 0 8px">Game Center</h2>
          <p class="muted">Control panel and game statistics</p>
        </div>

        <div class="stats-grid">
          <div class="stat">
            <div class="label">·ÄÇ·Ä≠·Äô·Ä∫·Ä∏</div>
            <div class="value">7</div>
          </div>
          <div class="stat">
            <div class="label">·Ä°·Äê·Äê·Ä∫</div>
            <div class="value">6</div>
          </div>
          <div class="stat">
            <div class="label">·ÄÄ·ÄÖ·Ä¨·Ä∏·Äõ·Äû·Ä∞·Äô·Äª·Ä¨·Ä∏</div>
            <div class="value">6</div>
          </div>
          <div class="stat">
            <div class="label">·ÄÖ·ÄÆ·Ä∏·Äï·ÄΩ·Ä¨·Ä∏</div>
            <div class="value">3,590</div>
          </div>
        </div>
      </section>

      <!-- PROFILE PAGE -->
      <section id="profilePage" class="card" style="display:none">
        <div style="text-align:center">
          <h2 style="margin:6px 0 8px">Profile</h2>
          <div class="profile">
            <img id="profilePhoto" src="https://via.placeholder.com/110" alt="Profile Photo">
            <div class="row"><div class="small muted">Name:</div> <div class="value" id="profileName">‚Äî</div></div>
            <div class="row"><div class="small muted">Username:</div> <div class="value" id="profileUsername">‚Äî</div></div>
            <div class="row"><div class="small muted">Chat ID:</div> <div class="value" id="profileChatID">‚Äî</div></div>
            <div style="margin-top:12px" class="small muted">Telegram info auto-detected when opened inside Telegram app</div>
          </div>
        </div>
      </section>
    </main>

    <!-- BOTTOM NAV + PLAYER -->
    <div style="padding:12px">
      <div class="player-bar card" id="playerBar">
        <div class="meta">
          <div class="title" id="nowTitle">No music</div>
          <div class="small muted" id="nowSource">‚Äî</div>
        </div>
        <div class="controls">
          <button id="playBtn" title="Play/Pause">‚ñ∂Ô∏è</button>
          <button id="stopBtn" title="Stop">‚èπÔ∏è</button>
        </div>
      </div>
    </div>

    <nav class="bottom-nav">
      <button id="navMain" class="nav-btn active">Main</button>
      <button id="navProfile" class="nav-btn">Profile</button>
    </nav>
  </div>

  <!-- MUSIC MODAL -->
  <div class="modal" id="musicModal" aria-hidden="true">
    <div class="modal-card">
      <h3>Custom Music</h3>

      <div class="option" id="optDefault">
        <div class="ico">üéµ</div>
        <div class="text">
          <div class="title">Default Music</div>
          <div class="sub">Use the original background music</div>
        </div>
      </div>

      <div class="option" id="optUrl">
        <div class="ico">üîó</div>
        <div class="text">
          <div class="title">Custom Music URL</div>
          <div class="sub">Enter a direct URL to your music file</div>
        </div>
      </div>

      <div class="option" id="optUpload">
        <div class="ico">üìÅ</div>
        <div class="text">
          <div class="title">Upload Music</div>
          <div class="sub">Select a music file from your device</div>
        </div>
      </div>

      <button class="cancel" id="closeModal">Cancel</button>
    </div>
  </div>

  <!-- Hidden audio element -->
  <audio id="audio" preload="auto"></audio>

<script>
/* ============================
   App logic (single-file)
   ============================ */
(function(){
  // Elements
  const navMain = document.getElementById('navMain');
  const navProfile = document.getElementById('navProfile');
  const mainPage = document.getElementById('mainPage');
  const profilePage = document.getElementById('profilePage');

  const musicBtn = document.getElementById('musicBtn');
  const musicModal = document.getElementById('musicModal');
  const closeModal = document.getElementById('closeModal');
  const optDefault = document.getElementById('optDefault');
  const optUrl = document.getElementById('optUrl');
  const optUpload = document.getElementById('optUpload');

  const audio = document.getElementById('audio');
  const playBtn = document.getElementById('playBtn');
  const stopBtn = document.getElementById('stopBtn');
  const nowTitle = document.getElementById('nowTitle');
  const nowSource = document.getElementById('nowSource');

  const imgBtn = document.getElementById('imgBtn');
  const volumeBtn = document.getElementById('volumeBtn');

  // Navigation
  function showMain(){
    mainPage.style.display = '';
    profilePage.style.display = 'none';
    navMain.classList.add('active');
    navProfile.classList.remove('active');
  }
  function showProfile(){
    mainPage.style.display = 'none';
    profilePage.style.display = '';
    navMain.classList.remove('active');
    navProfile.classList.add('active');
  }
  navMain.addEventListener('click', showMain);
  navProfile.addEventListener('click', showProfile);

  // Open music modal
  musicBtn.addEventListener('click', ()=> {
    musicModal.style.display = 'flex';
    musicModal.setAttribute('aria-hidden','false');
  });
  closeModal.addEventListener('click', ()=> {
    musicModal.style.display = 'none';
    musicModal.setAttribute('aria-hidden','true');
  });

  // Default music preset
  const defaultTrack = {
    src: "https://files.freemusicarchive.org/storage-freemusicarchive-org/music/no_curator/Scott_Holmes_Music/Happy_Music/Scott_Holmes_Music_-_Upbeat_Party.mp3",
    title: "Upbeat Party ‚Äî Scott Holmes (default)",
    source: "Default"
  };

  // Play helper
  function playTrack(track){
    if(!track || !track.src) return;
    audio.src = track.src;
    audio.play().catch(()=>{ /* autoplay blocked on browsers sometimes */ });
    nowTitle.innerText = track.title || "Playing";
    nowSource.innerText = track.source || "";
    playBtn.innerText = "‚è∏Ô∏è";
  }

  // Default option
  optDefault.addEventListener('click', ()=>{
    playTrack(defaultTrack);
    musicModal.style.display = 'none';
  });

  // URL option
  optUrl.addEventListener('click', async ()=>{
    const url = prompt("Enter direct music URL (mp3, ogg, etc.):");
    if(url){
      const t = { src: url, title: url.split('/').pop(), source: "Custom URL" };
      playTrack(t);
    }
    musicModal.style.display = 'none';
  });

  // Upload option
  optUpload.addEventListener('click', ()=>{
    const input = document.createElement('input');
    input.type = "file";
    input.accept = "audio/*";
    input.onchange = e => {
      const file = e.target.files[0];
      if(!file) return;
      const src = URL.createObjectURL(file);
      const t = { src, title: file.name, source: "Upload" };
      playTrack(t);
    };
    input.click();
    musicModal.style.display = 'none';
  });

  // Play/pause toggle
  playBtn.addEventListener('click', ()=>{
    if(audio.paused){
      audio.play().catch(()=>{});
      playBtn.innerText = "‚è∏Ô∏è";
    } else {
      audio.pause();
      playBtn.innerText = "‚ñ∂Ô∏è";
    }
  });

  stopBtn.addEventListener('click', ()=>{
    audio.pause();
    audio.currentTime = 0;
    playBtn.innerText = "‚ñ∂Ô∏è";
    nowTitle.innerText = "No music";
    nowSource.innerText = "‚Äî";
    audio.src = "";
  });

  // volume toggle (mute/unmute)
  let muted = false;
  volumeBtn.addEventListener('click', ()=>{
    muted = !muted;
    audio.muted = muted;
    volumeBtn.innerText = muted ? "üîà" : "üîä";
  });

  // image button ‚Äî open file to set profile photo locally (not uploaded)
  imgBtn.addEventListener('click', ()=>{
    const input = document.createElement('input');
    input.type = "file";
    input.accept = "image/*";
    input.onchange = e => {
      const file = e.target.files[0];
      if(!file) return;
      const src = URL.createObjectURL(file);
      document.getElementById('profilePhoto').src = src;
    };
    input.click();
  });

  /* ================================
     Telegram WebApp: auto profile
     ================================ */
  function initTelegramProfile(){
    try {
      const tg = window.Telegram?.WebApp;
      // If the app is opened in Telegram, tg exists and has initDataUnsafe
      let user = tg?.initDataUnsafe?.user;
      // Browser fallback: you can remove this fallback when using real Telegram
      if(!user){
        user = {
          id: 123456789,
          username: "testuser",
          first_name: "Test",
          last_name: "User",
          photo_url: ""
        };
      } else {
        // expand for better view inside Telegram
        try { tg.expand(); } catch(e){}
      }

      const displayName = (user.first_name || "") + (user.last_name ? (" " + user.last_name) : "");
      document.getElementById('profileName').innerText = displayName || "‚Äî";
      document.getElementById('profileUsername').innerText = user.username ? ("@" + user.username) : "‚Äî";
      document.getElementById('profileChatID').innerText = user.id || "‚Äî";
      if(user.photo_url){
        document.getElementById('profilePhoto').src = user.photo_url;
      } else {
        // placeholder if no photo
        document.getElementById('profilePhoto').src = "https://via.placeholder.com/110";
      }
    } catch (err){
      console.error("Telegram init error:", err);
    }
  }

  // Run init on load
  initTelegramProfile();

  // close modal when click outside
  musicModal.addEventListener('click', (e)=>{
    if(e.target === musicModal){
      musicModal.style.display = 'none';
    }
  });

  // Auto-hide modal on escape
  document.addEventListener('keydown', (e)=>{
    if(e.key === "Escape") musicModal.style.display = 'none';
  });

  // If you want the main tab visible by default
  showMain();

})();
</script>
</body>
</html>
